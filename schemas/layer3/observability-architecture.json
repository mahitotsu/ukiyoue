{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ukiyoue.example.org/schemas/layer3/observability-architecture.json",
  "title": "Observability Architecture",
  "description": "可観測性アーキテクチャ（ARCH-OBSERVABILITY）: 監視・ログ・トレースの設計",
  "allOf": [{ "$ref": "../_common.json#/definitions/baseArtifact" }],
  "type": "object",
  "required": ["title", "metricsDefinition"],
  "properties": {
    "@type": {
      "const": "ObservabilityArchitecture"
    },
    "title": {
      "type": "string",
      "minLength": 1
    },
    "metricsDefinition": {
      "type": "object",
      "properties": {
        "applicationMetrics": { "type": "string", "description": "レイテンシ、エラー率" },
        "infrastructureMetrics": { "type": "string", "description": "CPU、メモリ" }
      },
      "required": ["applicationMetrics"]
    },
    "logFormat": {
      "type": "object",
      "properties": {
        "format": { "type": "string", "description": "構造化ログ（JSON）" },
        "logLevel": { "type": "string" },
        "requiredFields": { "type": "array", "items": { "type": "string" } }
      }
    },
    "logRetention": {
      "type": "string",
      "description": "保存期間、アーカイブ戦略"
    },
    "traceDesign": {
      "type": "string",
      "description": "分散トレーシング、スパン設計"
    },
    "alertDesign": {
      "type": "object",
      "properties": {
        "conditions": { "type": "array", "items": { "type": "string" } },
        "thresholds": { "type": "string" },
        "notificationChannels": { "type": "array", "items": { "type": "string" } },
        "escalation": { "type": "string" }
      }
    },
    "dashboards": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "metrics": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "incidentResponseFlow": {
      "type": "string",
      "description": "検知→通知→対応→事後対応"
    }
  }
}
