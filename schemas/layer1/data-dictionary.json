{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ukiyoue.example.org/schemas/layer1/data-dictionary.json",
  "title": "Data Dictionary",
  "description": "データ辞書（BIZ-DICT）: プロジェクト固有の用語とその属性レベルの詳細を定義",
  "allOf": [{ "$ref": "../_common.json#/definitions/baseArtifact" }],
  "type": "object",
  "required": ["title", "terms"],
  "properties": {
    "@type": {
      "const": "DataDictionary"
    },
    "title": {
      "type": "string",
      "description": "データ辞書のタイトル",
      "minLength": 1
    },
    "overview": {
      "type": "string",
      "description": "データ辞書の概要"
    },
    "terms": {
      "type": "array",
      "description": "用語定義",
      "items": {
        "type": "object",
        "required": ["id", "term", "description"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^TERM-[A-Z]+-[0-9]{3}$",
            "description": "用語ID（例: TERM-TOS-001）"
          },
          "term": {
            "type": "string",
            "description": "用語名（例: Order ID, Order Status, Table Number）",
            "minLength": 1
          },
          "canonicalName": {
            "type": "string",
            "description": "正規化された用語名（変数名・フィールド名で使用すべき形式、例: OrderId, TableNumber）",
            "pattern": "^[A-Z][a-zA-Z0-9]*$"
          },
          "description": {
            "type": "string",
            "description": "用語のビジネス的な意味と説明",
            "minLength": 1
          },
          "domain": {
            "type": "string",
            "description": "用語のドメイン分類（ADR-009）",
            "enum": ["business", "system", "analytics", "infrastructure"]
          },
          "layer": {
            "type": "string",
            "description": "データモデリングのレイヤー（ADR-009）",
            "enum": ["conceptual", "logical", "physical"]
          },
          "dataType": {
            "type": "string",
            "description": "データ型（例: String, Integer, UUID, Decimal, Boolean, Date, DateTime, Enum）",
            "enum": [
              "String",
              "Integer",
              "Long",
              "Decimal",
              "Float",
              "Boolean",
              "Date",
              "DateTime",
              "Timestamp",
              "UUID",
              "Enum",
              "Array",
              "Object",
              "Binary"
            ]
          },
          "format": {
            "type": "string",
            "description": "データのフォーマット（例: YYYY-MM-DD, E.164, UUID v4, 正規表現パターン）"
          },
          "constraints": {
            "type": "object",
            "description": "制約条件",
            "properties": {
              "required": {
                "type": "boolean",
                "description": "必須か任意か",
                "default": false
              },
              "unique": {
                "type": "boolean",
                "description": "一意性制約があるか",
                "default": false
              },
              "minLength": {
                "type": "integer",
                "description": "最小文字数（文字列型の場合）",
                "minimum": 0
              },
              "maxLength": {
                "type": "integer",
                "description": "最大文字数（文字列型の場合）",
                "minimum": 0
              },
              "minValue": {
                "type": "number",
                "description": "最小値（数値型の場合）"
              },
              "maxValue": {
                "type": "number",
                "description": "最大値（数値型の場合）"
              },
              "pattern": {
                "type": "string",
                "description": "正規表現パターン"
              },
              "default": {
                "type": "string",
                "description": "デフォルト値"
              }
            }
          },
          "validationRules": {
            "type": "array",
            "description": "バリデーションルール",
            "items": {
              "type": "object",
              "required": ["rule", "description"],
              "properties": {
                "rule": {
                  "type": "string",
                  "description": "ルールの記述（例: 'Must be a valid email address', 'Must be in the future'）"
                },
                "description": {
                  "type": "string",
                  "description": "ルールの詳細説明"
                }
              }
            }
          },
          "allowedValues": {
            "type": "array",
            "description": "許容値のリスト（Enum型の場合）",
            "items": {
              "type": "object",
              "required": ["value", "description"],
              "properties": {
                "value": {
                  "type": "string",
                  "description": "許容される値"
                },
                "description": {
                  "type": "string",
                  "description": "値の意味"
                }
              }
            }
          },
          "examples": {
            "type": "array",
            "description": "具体的なデータ例",
            "items": {
              "type": "string"
            }
          },
          "businessRules": {
            "type": "array",
            "description": "この用語に関する単純な計算式や導出ルール（例: '合計金額 = 小計 + 消費税額'）。エンティティ間の複雑なビジネスロジックはConceptual Data Modelで定義すること",
            "items": {
              "type": "string"
            }
          },
          "relatedTerms": {
            "type": "array",
            "description": "関連する他の用語ID",
            "items": {
              "type": "string",
              "pattern": "^TERM-[A-Z]+-[0-9]{3}$"
            }
          },
          "synonyms": {
            "type": "array",
            "description": "同義語・別名（これらを使用した場合は警告が出る）",
            "items": {
              "type": "string"
            }
          },
          "deprecated": {
            "type": "boolean",
            "description": "非推奨フラグ（この用語は使用すべきでない）",
            "default": false
          },
          "replacedBy": {
            "type": "string",
            "description": "非推奨の場合、代替となる用語ID",
            "pattern": "^TERM-[A-Z]+-[0-9]{3}$"
          },
          "tags": {
            "type": "array",
            "description": "フリーフォームタグ（検索・分類用）",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "minItems": 1
    }
  }
}
