{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ukiyoue.example.org/schemas/layer1/risk-register.json",
  "title": "Risk Register",
  "description": "リスク登録簿（PM-RISK）: プロジェクトの全リスクを一元管理する文書",
  "allOf": [{ "$ref": "../_common.json#/definitions/baseArtifact" }],
  "type": "object",
  "required": ["title", "risks"],
  "properties": {
    "@type": {
      "const": "RiskRegister"
    },
    "title": {
      "type": "string",
      "description": "リスク登録簿のタイトル",
      "minLength": 1
    },
    "description": {
      "type": "string",
      "description": "リスク登録簿の概要"
    },
    "risks": {
      "type": "array",
      "description": "リスク一覧",
      "items": {
        "type": "object",
        "required": ["id", "description", "category", "impact", "probability"],
        "properties": {
          "id": {
            "type": "string",
            "description": "リスクの一意識別子（例: RISK-TOS-001）",
            "pattern": "^RISK-[A-Z0-9]+-[0-9]+$"
          },
          "description": {
            "type": "string",
            "description": "リスクの説明",
            "minLength": 1
          },
          "category": {
            "type": "string",
            "enum": [
              "technical",
              "operational",
              "schedule",
              "budget",
              "resource",
              "external",
              "quality",
              "security",
              "compliance",
              "other"
            ],
            "description": "リスクのカテゴリ"
          },
          "impact": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"],
            "description": "影響度（プロジェクトへの影響の大きさ）"
          },
          "probability": {
            "type": "string",
            "enum": ["high", "medium", "low"],
            "description": "発生確率"
          },
          "riskScore": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"],
            "description": "リスクスコア（impact × probability）: 自動計算または手動設定"
          },
          "status": {
            "type": "string",
            "enum": ["identified", "assessed", "mitigated", "monitoring", "closed", "realized"],
            "description": "リスクのステータス"
          },
          "owner": {
            "type": "string",
            "description": "リスクオーナー（対応責任者）"
          },
          "identifiedDate": {
            "type": "string",
            "format": "date",
            "description": "リスク識別日"
          },
          "mitigation": {
            "type": "object",
            "description": "軽減策",
            "properties": {
              "strategy": {
                "type": "string",
                "enum": ["avoid", "mitigate", "transfer", "accept"],
                "description": "リスク対応戦略"
              },
              "actions": {
                "type": "array",
                "items": { "type": "string" },
                "description": "具体的な軽減アクション"
              },
              "contingencyPlan": {
                "type": "string",
                "description": "コンティンジェンシープラン（リスク発生時の対応計画）"
              }
            }
          },
          "affectedArtifacts": {
            "type": "array",
            "items": { "type": "string" },
            "description": "影響を受ける成果物のIDリスト。成果物全体のIDを指定（例: pc-tos-001, roadmap-tos-001, us-tos-001）。フェーズIDなどネストしたオブジェクトのIDは指定しない"
          },
          "triggers": {
            "type": "array",
            "items": { "type": "string" },
            "description": "リスクのトリガー（リスク発生の兆候）"
          },
          "notes": {
            "type": "string",
            "description": "その他の備考"
          }
        }
      }
    },
    "assumptions": {
      "type": "array",
      "description": "前提条件一覧（リスクと密接に関連）",
      "items": {
        "type": "object",
        "required": ["id", "description"],
        "properties": {
          "id": {
            "type": "string",
            "description": "前提条件の一意識別子（例: ASMP-TOS-001）",
            "pattern": "^ASMP-[A-Z0-9]+-[0-9]+$"
          },
          "description": {
            "type": "string",
            "description": "前提条件の説明",
            "minLength": 1
          },
          "impact": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"],
            "description": "前提が崩れた場合の影響度"
          },
          "validationMethod": {
            "type": "string",
            "description": "前提条件の妥当性を検証する方法"
          },
          "relatedRisks": {
            "type": "array",
            "items": { "type": "string" },
            "description": "この前提条件に関連するリスクID"
          },
          "notes": {
            "type": "string",
            "description": "その他の備考"
          }
        }
      }
    }
  }
}
